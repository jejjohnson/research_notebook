
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Change of Variables &#8212; Research Notebook</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Identity Trick" href="identity_trick.html" />
    <link rel="prev" title="Sleeper Concepts" href="overview.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/book.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Research Notebook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Overview
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/python/overview.html">
   Python
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/jax_journey/overview.html">
   My JAX Journey
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/remote/overview.html">
   Remote Computing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Notes
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../bayesian/overview.html">
   Bayesian
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="overview.html">
   Sleeper Concepts
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Change of Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="identity_trick.html">
     Identity Trick
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="inverse_function.html">
     Inverse Function Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jensens.html">
     Jensens Inequality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lin_alg.html">
     Linear Algebra Tricks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../kernels/overview.html">
   Kernel Methods
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/notes/concepts/change_of_variables.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#normalizing-flows">
   Normalizing Flows
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="change-of-variables">
<h1>Change of Variables<a class="headerlink" href="#change-of-variables" title="Permalink to this headline">¶</a></h1>
<p>This is after making some transformation function, we can find the probability of that function by simply multiplying</p>
<hr class="docutils" />
<div class="section" id="normalizing-flows">
<h2>Normalizing Flows<a class="headerlink" href="#normalizing-flows" title="Permalink to this headline">¶</a></h2>
<p>First we will apply the change of variables formula from the perspective of parametric Gaussianization. Recall that we have our original data distribution <span class="math notranslate nohighlight">\(\mathcal{x}\)</span> and we want to find some transformation <span class="math notranslate nohighlight">\(z=\mathcal{G}_{\theta}(x)\)</span> such that <span class="math notranslate nohighlight">\(z\)</span> is drawn from a Gaussian distribution <span class="math notranslate nohighlight">\(z\sim \mathcal{N}(0, \mathbf{I})\)</span>.</p>
<p align="center">
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>graph LR
A((X)) -- D --&gt; B((Z))
</pre></div>
</div>
</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_x(x)=
\mathcal{P}_{z}\left( \mathcal{G}_{\theta}(x) \right)
\left| \frac{\partial \mathcal{G}_{\theta}(x)}{\partial x} \right|
\]</div>
<p>Let <span class="math notranslate nohighlight">\(z=\mathcal{G}_{\theta}(x)\)</span>, we can simplify the notation a bit:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_x(x)=
\mathcal{P}_{z}\left( z \right)
\left| \frac{\partial z}{\partial x} \right|
\]</div>
<p>Now we can rewrite this equation in terms of <span class="math notranslate nohighlight">\(\mathcal{P}_z(z)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_z(z)=
\mathcal{P}_{x}\left( x \right)
\left| \frac{\partial z}{\partial x} \right|^{-1}
\]</div>
<p>Let’s do the same thing as above but from the perspective of normalized flows (at least the original idea). I’ve seen the perspective of a transformation <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> that maps data from a latent space <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span> to the data space <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>.</p>
<p align="center">
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>graph LR
A((Z)) -- G --&gt; B((X))
</pre></div>
</div>
</p>
<p>In this instance, we have a generator <span class="math notranslate nohighlight">\(\mathcal{G}_{\theta}\)</span> that transforms the data from the latent space <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span> to the data space <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>. We can describe this as <span class="math notranslate nohighlight">\(x=\mathcal{G}_{\theta}(z)\)</span>, so therefore going from <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span> to <span class="math notranslate nohighlight">\(\mathcal{X}\)</span> is given by this equation <span class="math notranslate nohighlight">\(z = \mathcal{G}^{-1}_{\theta}(x)\)</span>. So first, let’s write out the transformation not including the function values.</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_x(x)=\mathcal{P}_z\left[ z \right] \left| \text{det} \frac{\partial z}{\partial x} \right|\]</div>
<p>Now let’s add in the function values taking into account that <span class="math notranslate nohighlight">\(z = \mathcal{G}^{-1}_{\theta}(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_x(x)=\mathcal{P}_z\left[ \mathcal{G}_{\theta}^{-1}(x) \right] \left| \text{det} \frac{\partial \mathcal{G}_{\theta}^{-1}(x)}{\partial x} \right|\]</div>
<p>Here, we have something different because we have the determinant of a function’s inverse. We assume that <span class="math notranslate nohighlight">\(\mathcal{G}_{\theta}\)</span> is invertible which would allow us to use the <strong>inverse function theorem</strong> to move the inverse outside of the <span class="math notranslate nohighlight">\(\mathcal{G}_{\theta}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_x(x)=\mathcal{P}_z\left[ \mathcal{G}_{\theta}^{-1}(x) \right] \left| \text{det} \left(\frac{\partial \mathcal{G}_{\theta}(z)}{\partial x}\right)^{-1} \right|\]</div>
<p>And now we can use the fact that the determinant of the inverse of the Jacobian of invertible function is simply the inverse of the determinant of the Jacobian of the invertible function. In words, that’s a lot to unpack, but it basically means that:</p>
<div class="math notranslate nohighlight">
\[ \left| \text{det} \left(\frac{\partial \mathcal{G}_{\theta}(z)}{\partial x}\right)^{-1} \right| = \left| \text{det} \frac{\partial \mathcal{G}_{\theta}(z)}{\partial x} \right|^{-1}\]</div>
<p>So with this last idea in mind, we can finally construct the final form:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_x(x)=\mathcal{P}_z\left[ \mathcal{G}_{\theta}^{-1}(x) \right] \left| \text{det} \frac{\partial \mathcal{G}_{\theta}(z)}{\partial x} \right|^{-1}\]</div>
<p>Again, we can write this in terms of <span class="math notranslate nohighlight">\(\mathcal{P}_z(z)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}_z(z)=\mathcal{P}_x (x) \left| \text{det} \frac{\partial \mathcal{G}_{\theta}(z)}{\partial x} \right|\]</div>
<p><strong>Resources</strong>:</p>
<ul class="simple">
<li><p>Youtube:</p>
<ul>
<li><p>Professor Leonard - <a class="reference external" href="https://www.youtube.com/watch?v=VVPu5fWssPg&amp;t=3648s">How to Change Variables in Multiple Integrals (Jacobian)</a></p></li>
<li><p>mrgonzalezWHS - <a class="reference external" href="https://www.youtube.com/watch?v=1TPFb1aKMvk&amp;t=198s">Change of Variables. Jacobian</a></p></li>
<li><p>Kishore Kashyap - <a class="reference external" href="https://www.youtube.com/watch?v=6iphG6-iTo4&amp;t=213s">Transformations I</a> | <a class="reference external" href="https://www.youtube.com/watch?v=WOdgojmlZSQ">Transformations II</a></p></li>
</ul>
</li>
<li><p>MathInsight</p>
<ul>
<li><p><a class="reference external" href="https://mathinsight.org/double_integral_change_variables_introduction">Double Integrals</a> | <a class="reference external" href="https://mathinsight.org/double_integral_change_variable_examples">Example</a></p></li>
</ul>
</li>
<li><p>Course</p>
<ul>
<li><p>Cambridge</p>
<ul>
<li><p><a class="reference external" href="https://www.cl.cam.ac.uk/teaching/0708/Probabilty/prob11.pdf">Transforming Density Functions</a></p></li>
<li><p><a class="reference external" href="https://www.cl.cam.ac.uk/teaching/0708/Probabilty/prob12.pdf">Transforming Bivariate Density Functions</a></p></li>
</ul>
</li>
<li><p>Pauls Online Math Notes</p>
<ul>
<li><p><a class="reference external" href="http://tutorial.math.lamar.edu/Classes/CalcIII/ChangeOfVariables.aspx">Change of Variables</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Teaching Notes</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cl.cam.ac.uk/teaching/2003/Probability/prob11.pdf">Transforming Density Functions</a></p></li>
<li><p><a class="reference external" href="https://faculty.math.illinois.edu/~r-ash/Stat/StatLec1-5.pdf">Transformation of RVs</a></p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/notes/concepts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="overview.html" title="previous page">Sleeper Concepts</a>
    <a class='right-next' id="next-link" href="identity_trick.html" title="next page">Identity Trick</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By J. Emmanuel Johnson<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>